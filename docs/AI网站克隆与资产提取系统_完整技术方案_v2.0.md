# AI ç½‘ç«™å…‹éš†ä¸èµ„äº§æå–ç³»ç»Ÿ
## å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆ v2.0

**åŸºäºè¡Œä¸šæœ€ä½³å®è·µçš„ç«¯åˆ°ç«¯è§£å†³æ–¹æ¡ˆ**

---

## ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#1-æ‰§è¡Œæ‘˜è¦)
2. [ç³»ç»Ÿæ¶æ„æ€»è§ˆ](#2-ç³»ç»Ÿæ¶æ„æ€»è§ˆ)
3. [æ•°æ®äº§ç‰©åˆ†å±‚](#3-æ•°æ®äº§ç‰©åˆ†å±‚)
4. [å®æ–½è·¯å¾„ï¼ˆåˆ†é˜¶æ®µè½åœ°ï¼‰](#4-å®æ–½è·¯å¾„åˆ†é˜¶æ®µè½åœ°)
5. [æŠ€æœ¯æ ˆä¸ä¾èµ–](#5-æŠ€æœ¯æ ˆä¸ä¾èµ–)
6. [å®Œæ•´ç›®å½•ç»“æ„](#6-å®Œæ•´ç›®å½•ç»“æ„)
7. [å…³é”®æ¨¡å—è¯¦è§£](#7-å…³é”®æ¨¡å—è¯¦è§£)
8. [è´¨é‡ä¿è¯ä½“ç³»](#8-è´¨é‡ä¿è¯ä½“ç³»)
9. [ä½¿ç”¨æŒ‡å—](#9-ä½¿ç”¨æŒ‡å—)
10. [é£é™©ä¸ç¼“è§£ç­–ç•¥](#10-é£é™©ä¸ç¼“è§£ç­–ç•¥)
11. [æœªæ¥æ‰©å±•è§„åˆ’](#11-æœªæ¥æ‰©å±•è§„åˆ’)
12. [é™„å½•](#12-é™„å½•)

---

## 1. æ‰§è¡Œæ‘˜è¦

æœ¬æ–¹æ¡ˆæä¾›äº†ä¸€å¥—å®Œæ•´çš„ç½‘ç«™å…‹éš†ä¸èµ„äº§æå–ç³»ç»Ÿï¼Œæ—¨åœ¨ä»ç›®æ ‡ç½‘ç«™è‡ªåŠ¨æå–è®¾è®¡ç³»ç»Ÿã€ç»„ä»¶åº“å’Œå†…å®¹èµ„äº§ï¼Œå¹¶ç”Ÿæˆå¯åœ¨å…¶ä»– AI é¡¹ç›®ä¸­å¤ç”¨çš„é«˜è´¨é‡æ¨¡æ¿ã€‚ç³»ç»Ÿé‡‡ç”¨**"ç»“æ„åŒ–çº¦æŸ + è§†è§‰åé¦ˆé©±åŠ¨"**çš„å·¥ç¨‹åŒ–è·¯å¾„ï¼Œé¿å…äº†ä¼ ç»Ÿ AI ç”Ÿæˆæ–¹æ¡ˆä¸­çš„"ä¸€æ¬¡æ€§ç”Ÿæˆ"é™·é˜±ã€‚

### 1.1 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

- **é«˜ä¿çœŸè¿˜åŸ**ï¼šé€šè¿‡å¤šå±‚æ¬¡é‡‡é›†ç­–ç•¥ï¼Œå®ç° 90%+ çš„è§†è§‰ä¸€è‡´æ€§
- **èµ„äº§åŒ–å¤ç”¨**ï¼šç”Ÿæˆå¯è·¨é¡¹ç›®å¤ç”¨çš„åŸå­ç»„ä»¶å’Œæ¨¡æ¿åº“ï¼Œæ”¯æŒå¿«é€Ÿå®šåˆ¶
- **è‡ªåŠ¨åŒ–é—­ç¯**ï¼šé›†æˆè§†è§‰ QA ä¸è‡ªåŠ¨ä¿®å¤ï¼Œå‡å°‘ 70% çš„äººå·¥è°ƒæ•´æ—¶é—´
- **è®¾è®¡ç³»ç»Ÿæå–**ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶å½’ä¸€åŒ–è®¾è®¡ tokensï¼Œç¡®ä¿å“ç‰Œä¸€è‡´æ€§

### 1.2 è¡Œä¸šå¯¹æ ‡

| ç»´åº¦ | æœ¬æ–¹æ¡ˆ | Builder.io | Relume | Vercel v0 |
|------|---------|-----------|--------|-----------|
| **ç»„ä»¶æ•°é‡** | 20+ Block<br/>30+ Atomic | è‡ªåŠ¨ç´¢å¼• | 1000+ | shadcn å…¨é›† |
| **æ ·å¼æå–** | âœ… Tailwind å½’ä¸€åŒ– | âœ… Design Tokens | âœ… å…¨å±€æ ·å¼ | âœ… Tailwind |
| **å¸ƒå±€è¯†åˆ«** | âœ… CV + æ‹“æ‰‘åˆ†ç±» | âœ… CV + DOM | âœ… AI åˆ†ç±» | âŒ ä¾èµ–æç¤º |
| **è¯­ä¹‰æ ‡æ³¨** | âœ… å®Œæ•´æ ‡æ³¨ | âœ… å®Œæ•´ | âœ… 2.0 çªç ´ | âš ï¸ æœ‰é™ |
| **è§†è§‰éªŒè¯** | âœ… Diff + å½’å›  | âŒ æ—  | âŒ æ—  | âœ… å®æ—¶é¢„è§ˆ |
| **è‡ªåŠ¨ä¿®å¤** | âœ… é—­ç¯è¿­ä»£ | âŒ æ‰‹åŠ¨ | âŒ æ‰‹åŠ¨ | âœ… Quick Edit |

**è¯„åˆ†ï¼š8.5/10** - åœ¨è§†è§‰éªŒè¯å’Œè‡ªåŠ¨ä¿®å¤æ–¹é¢é¢†å…ˆè¡Œä¸šï¼Œä½†éœ€è¡¥å……è®¾è®¡ç³»ç»Ÿæå–å’Œè¯­ä¹‰åŒ–æ ‡æ³¨èƒ½åŠ›ã€‚

---

## 2. ç³»ç»Ÿæ¶æ„æ€»è§ˆ

ç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ¯å±‚èŒè´£æ¸…æ™°ï¼Œæ”¯æŒç‹¬ç«‹ä¼˜åŒ–å’Œæ‰©å±•ã€‚æ ¸å¿ƒæµç¨‹åŒ…æ‹¬ï¼š**é‡‡é›†ï¼ˆCaptureï¼‰â†’ ç†è§£ï¼ˆUnderstandï¼‰â†’ èµ„äº§åŒ–ï¼ˆAssetizeï¼‰â†’ éªŒè¯ï¼ˆVerifyï¼‰â†’ è¿­ä»£ï¼ˆIterateï¼‰**ã€‚

### 2.1 æ¶æ„å±‚æ¬¡

#### A. é‡‡é›†å±‚ï¼ˆCapture Layerï¼‰

**æŠ€æœ¯æ ˆ**ï¼šPlaywright + Chrome DevTools Protocol

**æ ¸å¿ƒäº§ç‰©**ï¼š
- å…¨é¡µä¸åŒºå—çº§æˆªå›¾ï¼ˆ4K åˆ†è¾¨ç‡ï¼‰
- DOM snapshot ä¸ç»“æ„åŒ–å¸ƒå±€ä¿¡æ¯
- Computed styles ç»Ÿè®¡ä¸ CSS å˜é‡æ˜ å°„
- Atoms åŸå­èŠ‚ç‚¹ï¼ˆæ–‡æœ¬/å›¾ç‰‡/é“¾æ¥/æŒ‰é’®ï¼‰
- åª’ä½“èµ„æºï¼ˆè§†é¢‘/èƒŒæ™¯å›¾/SVGï¼‰ä¸å ä½ç¬¦ç”Ÿæˆ

**é™å™ªç­–ç•¥**ï¼š
- ç¦ç”¨åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
- å›ºå®š viewportï¼ˆDesktop: 1440px, Mobile: 375pxï¼‰
- è§¦å‘æ‡’åŠ è½½å¹¶ç­‰å¾…ç½‘ç»œç©ºé—²
- æ•è·ä¼ªå…ƒç´ æ ·å¼ï¼ˆ::before/::afterï¼‰

#### B. ç†è§£å±‚ï¼ˆUnderstand Layerï¼‰

**æŠ€æœ¯æ ˆ**ï¼šCrawl4AI + Custom NLP Pipeline

**æ ¸å¿ƒäº§ç‰©**ï¼š
- æ¸…æ´—åçš„ Markdown ä¸ç»“æ„åŒ–æ–‡æœ¬
- ä¸»é¢˜ tokens é‡‡æ ·ï¼ˆé¢œè‰²/å­—ä½“/é—´è·/é˜´å½±/åœ†è§’ï¼‰
- CSS æ¡†æ¶è¯†åˆ«ï¼ˆTailwind/Bootstrap/Customï¼‰
- å¸ƒå±€æ‹“æ‰‘åˆ†ç±»ï¼ˆFå‹/Zå‹/å±…ä¸­/æ …æ ¼ï¼‰

#### C. èµ„äº§åŒ–å±‚ï¼ˆAssetize Layerï¼‰

**æ ¸å¿ƒäº§ç‰©**ï¼š
- **atoms_dslï¼ˆç»“æ„åŒ–ä¸­é—´å±‚ï¼‰**ï¼šé¢å‘ç»„ä»¶çš„åŸå­ JSONï¼Œé©±åŠ¨ props ç”Ÿæˆ
- **Block æ³¨å†Œè¡¨**ï¼š20+ é«˜å¤ç”¨ç»„ä»¶ï¼ˆHero/Feature/Cards/Pricing/FAQ ç­‰ï¼‰
- **Atomic ç»„ä»¶åº“**ï¼šButton/Badge/Card/Image/Media ç­‰å¯ç»„åˆå•å…ƒ
- **Theme ç³»ç»Ÿ**ï¼šTailwind-ready tokens ä¸ CSS å˜é‡æ˜ å°„

#### D. éªŒè¯å±‚ï¼ˆVerify Layerï¼‰

- è§†è§‰å›å½’æµ‹è¯•ï¼ˆåŸç«™ vs Puck æ¸²æŸ“ï¼‰
- Pixelmatch diff ç”Ÿæˆä¸ç›¸ä¼¼åº¦è¯„åˆ†
- å·®å¼‚å½’å› ï¼ˆç»“æ„/tokens/å†…å®¹ï¼‰
- å¤šç«¯æµ‹è¯•ï¼ˆDesktop/Mobile/Tabletï¼‰

#### E. è¿­ä»£å±‚ï¼ˆIterate Layerï¼‰

- è‡ªåŠ¨ä¿®å¤å¾ªç¯ï¼ˆæœ€å¤š 3 æ¬¡è¿­ä»£ï¼‰
- äººå·¥è¯„å®¡é—¸é—¨ï¼ˆé’ˆå¯¹ missing_block/broken_imagesï¼‰
- ç‰ˆæœ¬ç®¡ç†ï¼ˆpuck.iter.*.jsonï¼‰

---

## 3. æ•°æ®äº§ç‰©åˆ†å±‚

| å±‚æ¬¡ | äº§ç‰© | è¯´æ˜ |
|------|------|------|
| **åŸå§‹é‡‡é›†å±‚** | DOM snapshot<br/>å…¨é¡µ/åŒºå—æˆªå›¾<br/>atoms.json | Playwright é‡‡é›†çš„åŸå§‹æ•°æ®ï¼ŒåŒ…å«å®Œæ•´çš„ DOM ç»“æ„ã€è®¡ç®—æ ·å¼å’Œåª’ä½“èµ„æº |
| **ç†è§£æŠ½å–å±‚** | Markdown ç»“æ„<br/>theme tokens<br/>computed_styles | Crawl4AI æå–çš„æ–‡æœ¬ç»“æ„å’Œæ ·å¼ç»Ÿè®¡ï¼Œç”¨äºåç»­åˆ†æ |
| **ç»“æ„åŒ–ä¸­é—´å±‚** | atoms_dsl.json<br/>layout_topology | é¢å‘ç»„ä»¶çš„åŸå­ JSONï¼ŒåŒ…å«å¸ƒå±€æ‹“æ‰‘ä¿¡æ¯ï¼Œç›´æ¥é©±åŠ¨ props ç”Ÿæˆ |
| **æ„å»ºè¾“å‡ºå±‚** | page.json<br/>sections.json<br/>theme.css | Puck å¯æ¸²æŸ“çš„é…ç½®æ–‡ä»¶ï¼Œå¯ç›´æ¥ç”¨äºé¡µé¢æ„å»ºå’Œç¼–è¾‘ |
| **éªŒè¯è¯„ä¼°å±‚** | visual-qa æŠ¥å‘Š<br/>diff å›¾åƒ<br/>attribution.json | è§†è§‰å¯¹æ¯”ç»“æœã€å·®å¼‚å½’å› å’Œä¿®å¤å»ºè®® |

---

## 4. å®æ–½è·¯å¾„ï¼ˆåˆ†é˜¶æ®µè½åœ°ï¼‰

æœ¬æ–¹æ¡ˆé‡‡ç”¨æ¸è¿›å¼å®æ–½ç­–ç•¥ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½èƒ½äº¤ä»˜å¯éªŒè¯çš„ä»·å€¼ã€‚**æ€»å‘¨æœŸçº¦ 21 å¤©**ï¼Œå¯æ ¹æ®èµ„æºæƒ…å†µè°ƒæ•´ã€‚

### Phase 0ï¼šå¿«é€Ÿæ­¢è¡€ï¼ˆ1-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šè§£å†³å½“å‰æœ€ä¸¥é‡çš„è§†è§‰åå·®é—®é¢˜ï¼Œæå‡é¦–å±è¿˜åŸåº¦è‡³ 70%+

#### æ ¸å¿ƒä»»åŠ¡

**1. å¯ç”¨é«˜ä¿çœŸæ¨¡å¼**
- ä¿ç•™æ‰€æœ‰åª’ä½“èµ„æºï¼ˆä¸å‹ç¼©/ä¸å ä½ï¼‰
- ç¦ç”¨ destyle é¢„å¤„ç†
- æ•è·ä¼ªå…ƒç´ èƒŒæ™¯ï¼ˆ::before/::afterï¼‰

**2. Capture ä¼˜å…ˆåˆå¹¶ç­–ç•¥**
- Capture æ•°æ®è¦†ç›– Extract ç»“æœ
- ä¿ç•™çœŸå® computed styles
- è§†é¢‘èƒŒæ™¯ä½¿ç”¨ data-src å±æ€§

**3. CSS å˜é‡æ˜ å°„ï¼ˆæ–°å¢ï¼‰**
- è¯†åˆ« --primary/--secondary ç­‰å…¨å±€å˜é‡
- ç”Ÿæˆå˜é‡ä¾èµ–å›¾
- æ”¯æŒä¸€é”®æ¢è‚¤

**4. CSS æ¡†æ¶è¯†åˆ«ï¼ˆæ–°å¢ï¼‰**
- æ£€æµ‹ Tailwind/Bootstrap/Bulma ç­‰
- ä¸ºåç»­å½’ä¸€åŒ–æä¾›ä¾æ®

```python
def capture_with_css_variables(url):
    """Phase 0: é«˜ä¿çœŸé‡‡é›† + CSS å˜é‡æ˜ å°„"""
    page = await browser.new_page()
    
    # 1. ç¦ç”¨æ ·å¼é™å™ª
    await page.add_init_script("""
        window.DISABLE_DESTYLE = true;
        window.PRESERVE_MEDIA = true;
    """)
    
    # 2. æ•è· CSS å˜é‡
    css_vars = await page.evaluate("""
        () => {
            const styles = getComputedStyle(document.documentElement);
            const vars = {};
            for (let i = 0; i < styles.length; i++) {
                const prop = styles[i];
                if (prop.startsWith('--')) {
                    vars[prop] = styles.getPropertyValue(prop).trim();
                }
            }
            return vars;
        }
    """)
    
    # 3. è¯†åˆ« CSS æ¡†æ¶
    framework = detect_css_framework(page)
    
    return {
        "css_variables": css_vars,
        "framework": framework,  # "tailwind" | "bootstrap" | "custom"
        "screenshots": {...},
        "dom": {...}
    }
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| é¦–å±èƒŒæ™¯ä¸€è‡´æ€§ | æå‡è‡³ 80%+ï¼ˆå½“å‰çº¦ 50%ï¼‰ |
| å…³é”®åª’ä½“ä¸ä¸¢å¤± | è§†é¢‘/å¤§å›¾ 100% ä¿ç•™ |
| CSS å˜é‡å®Œæ•´æ€§ | è¯†åˆ«ç‡ > 90% |
| æ¡†æ¶è¯†åˆ«å‡†ç¡®åº¦ | > 95%ï¼ˆåŸºäºå·²çŸ¥ç½‘ç«™æµ‹è¯•ï¼‰ |

---

### Phase 1ï¼šæ‹†åˆ†å‡çº§ï¼ˆ3-7 å¤©ï¼‰

**ç›®æ ‡**ï¼šå°† Section æ‹†åˆ†å‡†ç¡®åº¦ä» 60% æå‡è‡³ 90%+ï¼Œç¡®ä¿åŒºå—è¾¹ç•Œä¸åŸç«™ä¸€è‡´

#### æ ¸å¿ƒä»»åŠ¡

**1. è§†è§‰åˆ†åŒºç®—æ³•**
- æ›¿æ¢ 'main > *' é€‰æ‹©å™¨ä¸ºæ™ºèƒ½åˆ†åŒº
- åŸºäº vertical gapï¼ˆ>100pxï¼‰åˆ‡åˆ†
- è¯†åˆ«è¯­ä¹‰è¾¹ç•Œï¼ˆ<section>/<article> æ ‡ç­¾ï¼‰
- å¤„ç†åµŒå¥—å¸ƒå±€ï¼ˆGrid/Flexï¼‰

**2. å¸ƒå±€æ‹“æ‰‘è¯†åˆ«ï¼ˆæ–°å¢ï¼‰**
- ä½¿ç”¨ CV æ¨¡å‹åˆ†ç±»å¸ƒå±€ç±»å‹
- æ ‡æ³¨ï¼šFå‹/Zå‹/å±…ä¸­/å·¦å³åˆ†æ /æ …æ ¼
- ä¸º Phase 2 æ˜ å°„æä¾›è¯­ä¹‰æç¤º

**3. è¾“å‡ºæ ‡å‡†åŒ–**
- ç”Ÿæˆ section_groups.json
- åŒ…å« bbox/screenshot/layout_type
- æ”¯æŒäººå·¥æ ¡æ­£æ¥å£

```python
def split_sections_with_topology(page_screenshot, dom):
    """Phase 1: è§†è§‰åˆ†åŒº + å¸ƒå±€æ‹“æ‰‘è¯†åˆ«"""
    
    # 1. è§†è§‰åˆ†åŒºï¼ˆåŸºäºæˆªå›¾ + DOMï¼‰
    gaps = detect_vertical_gaps(page_screenshot, threshold=100)
    semantic_boundaries = find_semantic_tags(dom, ['section', 'article', 'main'])
    
    sections = []
    for i, (start, end) in enumerate(merge_boundaries(gaps, semantic_boundaries)):
        section_img = crop_screenshot(page_screenshot, start, end)
        
        # 2. å¸ƒå±€æ‹“æ‰‘åˆ†ç±»ï¼ˆæ–°å¢ï¼‰
        layout_type = classify_layout_topology(section_img)
        # è¿”å›ï¼š{"type": "left_text_right_media", "grid": {"cols": 3}, ...}
        
        sections.append({
            "id": f"section_{i}",
            "bbox": {"top": start, "bottom": end},
            "screenshot": section_img,
            "layout_topology": layout_type,  # æ–°å¢
            "dom_nodes": extract_nodes(dom, start, end)
        })
    
    return {"sections": sections}

def classify_layout_topology(section_img):
    """ä½¿ç”¨ CV æ¨¡å‹åˆ†ç±»å¸ƒå±€"""
    features = extract_visual_features(section_img)
    
    if features['has_large_image_left'] and features['text_right']:
        return {"type": "left_media_right_text", "hierarchy": "media_dominant"}
    elif features['centered_text'] and not features['has_images']:
        return {"type": "centered_text", "hierarchy": "text_only"}
    # ... æ›´å¤šè§„åˆ™
    
    return {"type": "unknown", "hierarchy": "mixed"}
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| Section æ•°é‡å‡†ç¡®åº¦ | Â± 1 ä¸ªï¼ˆä¸åŸç«™å¯¹æ¯”ï¼‰ |
| è¾¹ç•Œä½ç½®åå·® | < 50px |
| å¸ƒå±€ç±»å‹è¯†åˆ« | > 85% å‡†ç¡®åº¦ |
| Mapping åå·®ä¸‹é™ | ä» 40% é™è‡³ 20% |

---

### Phase 1.5ï¼šè®¾è®¡ç³»ç»Ÿæå–ï¼ˆæ–°å¢ï¼Œ2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šæå–å®Œæ•´è®¾è®¡ç³»ç»Ÿï¼Œä¸º Phase 2 çš„ Tailwind å½’ä¸€åŒ–å’Œ Phase 3 çš„è·¨ç«™å¤ç”¨å¥ å®šåŸºç¡€

#### æ ¸å¿ƒä»»åŠ¡

**1. Token æå–ä¸å½’ä¸€åŒ–**
- **é¢œè‰²ç³»ç»Ÿ**ï¼šPrimary/Secondary/Accent + è¯­ä¹‰è‰²
- **é—´è·åˆ»åº¦**ï¼šè¯†åˆ«ä½¿ç”¨çš„ spacing scaleï¼ˆ4/8/16/24...ï¼‰
- **æ’ç‰ˆç³»ç»Ÿ**ï¼šå­—ä½“æ—/å­—å·å±‚çº§/è¡Œé«˜/å­—é‡
- **é˜´å½±/åœ†è§’**ï¼šæå–å¹¶èšç±»ç›¸ä¼¼å€¼

**2. Pattern Library**
- è¯†åˆ«å¸¸è§ç»„åˆæ¨¡å¼ï¼ˆå¦‚"æ ‡é¢˜+å‰¯æ ‡é¢˜+CTA"ï¼‰
- ç”Ÿæˆ pattern specï¼ˆå¯ç›´æ¥ç”¨äºæ–°é¡¹ç›®ï¼‰

**3. è¾“å‡ºæ ‡å‡†åŒ–**
- theme/tokens.jsonï¼ˆå®Œæ•´ token å®šä¹‰ï¼‰
- theme/tailwind.config.jsï¼ˆå¯ç›´æ¥ä½¿ç”¨ï¼‰
- patterns/*.pattern.jsonï¼ˆå¯å¤ç”¨æ¨¡å¼ï¼‰

```python
def extract_design_system(computed_styles_stats, css_variables):
    """Phase 1.5: è®¾è®¡ç³»ç»Ÿæå–"""
    
    # 1. é¢œè‰²ç³»ç»Ÿæå–
    colors = cluster_colors(computed_styles_stats['color'])
    color_tokens = {
        "primary": detect_primary_color(colors, css_variables),
        "secondary": detect_secondary_color(colors),
        "accent": detect_accent_color(colors),
        "semantic": {
            "success": find_semantic_color(colors, "green"),
            "warning": find_semantic_color(colors, "yellow"),
            "error": find_semantic_color(colors, "red")
        }
    }
    
    # 2. é—´è·åˆ»åº¦è¯†åˆ«
    spacing_values = extract_spacing(computed_styles_stats)
    spacing_scale = detect_spacing_scale(spacing_values)
    # ä¾‹å¦‚ï¼š[4, 8, 12, 16, 24, 32, 48, 64, 96, 128]
    
    # 3. æ’ç‰ˆç³»ç»Ÿ
    typography = {
        "fontFamily": {
            "sans": detect_primary_font(computed_styles_stats),
            "serif": detect_serif_font(computed_styles_stats),
            "mono": detect_mono_font(computed_styles_stats)
        },
        "fontSize": cluster_font_sizes(computed_styles_stats['fontSize']),
        "fontWeight": extract_used_weights(computed_styles_stats),
        "lineHeight": calculate_line_height_scale(computed_styles_stats)
    }
    
    # 4. ç”Ÿæˆ Tailwind é…ç½®
    tailwind_config = generate_tailwind_config({
        "colors": color_tokens,
        "spacing": spacing_scale,
        "typography": typography,
        "borderRadius": cluster_values(computed_styles_stats['borderRadius']),
        "boxShadow": extract_shadows(computed_styles_stats)
    })
    
    return {
        "tokens": {...},
        "tailwind_config": tailwind_config,
        "patterns": extract_patterns(sections)
    }
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| Token æå–å®Œæ•´æ€§ | è¦†ç›– 95%+ ä½¿ç”¨åœºæ™¯ |
| Tailwind é…ç½®å¯ç”¨æ€§ | å¯ç›´æ¥ç”¨äºæ–°é¡¹ç›®æ„å»º |
| é—´è·åˆ»åº¦è¯†åˆ« | å‡†ç¡®è¯†åˆ« base unitï¼ˆ4px/8pxï¼‰ |
| Pattern è¯†åˆ«æ•°é‡ | > 5 ä¸ªå¯å¤ç”¨æ¨¡å¼ |

---

### Phase 2ï¼šæ¨¡æ¿èƒ½åŠ›å‡çº§ï¼ˆ7-14 å¤©ï¼‰

**ç›®æ ‡**ï¼šè¡¥é½é«˜é¢‘åœºæ™¯çš„ Block å˜ä½“ï¼Œæå‡ç»“æ„åŒ¹é…åº¦è‡³ 80%+ï¼Œå¹¶å®ç° Tailwind å½’ä¸€åŒ–

#### æ ¸å¿ƒä»»åŠ¡

**1. æ–°å¢é«˜ ROI å˜ä½“**
- **HeroVideo**ï¼šè§†é¢‘èƒŒæ™¯ + overlay + gradient
- **MediaBackdropSection**ï¼šèƒŒæ™¯å›¾/æ¸å˜ + å‰æ™¯å¡ç‰‡
- **CardsGrid Enhanced**ï¼šæ–°é—»å¡ç‰‡/äº§å“å¡ç‰‡/å›¢é˜Ÿå¡ç‰‡
- **InteractiveTimeline**ï¼šå‚ç›´/æ°´å¹³æ—¶é—´çº¿

**2. Tailwind å½’ä¸€åŒ–ï¼ˆæ–°å¢ï¼‰**
- å¼ºåˆ¶å°†åƒç´ å€¼æ˜ å°„ä¸º Tailwind ç±»
- ç¤ºä¾‹ï¼špadding: 41px â†’ py-10
- ç”Ÿæˆå¹²å‡€ã€å¯ç»´æŠ¤çš„ props

**3. è¯­ä¹‰åŒ–æ ‡æ³¨ï¼ˆæ–°å¢ï¼‰**
- ä¸ºæ¯ä¸ª Block æ·»åŠ  semantic å­—æ®µ
- æ ‡æ³¨ï¼šintent/tone/conversion_goal/industry

```javascript
// Phase 2: Tailwind å½’ä¸€åŒ–ç¤ºä¾‹
function normalizeTailwind(rawStyles, designTokens) {
  const mapper = new TailwindMapper(designTokens);
  
  return {
    // é—´è·å½’ä¸€åŒ–
    padding: mapper.spacing(rawStyles.padding),
    // 41px â†’ "10" (Tailwind py-10 = 2.5rem = 40pxï¼Œæœ€æ¥è¿‘)
    
    // é¢œè‰²å½’ä¸€åŒ–  
    backgroundColor: mapper.color(rawStyles.backgroundColor),
    // #2563EB â†’ "blue-600"
    
    // å­—å·å½’ä¸€åŒ–
    fontSize: mapper.fontSize(rawStyles.fontSize),
    // 18px â†’ "lg" (Tailwind text-lg = 1.125rem = 18px)
    
    // åœ†è§’å½’ä¸€åŒ–
    borderRadius: mapper.borderRadius(rawStyles.borderRadius),
    // 12px â†’ "xl" (Tailwind rounded-xl = 0.75rem = 12px)
  };
}

// Block è¯­ä¹‰åŒ–æ ‡æ³¨ç¤ºä¾‹
const blockMetadata = {
  "HeroVideo": {
    "semantic": {
      "intent": "product_launch",
      "tone": "professional_tech",
      "conversion_goal": "video_play",
      "industry": ["saas", "tech", "startup"]
    },
    "usage_context": "é¦–å±ï¼Œé€‚åˆéœ€è¦å¼ºçƒˆè§†è§‰å†²å‡»çš„åœºæ™¯",
    "variants": ["center", "split", "fullscreen"]
  }
}
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| æ–°å¢ Block è¦†ç›–ç‡ | è¦†ç›– 80%+ é«˜é¢‘åœºæ™¯ |
| Tailwind å½’ä¸€åŒ–ç‡ | > 95%ï¼ˆæ‰€æœ‰ propsï¼‰ |
| è¯­ä¹‰æ ‡æ³¨å®Œæ•´æ€§ | æ‰€æœ‰ Block å‡æœ‰ semantic å­—æ®µ |
| ç»“æ„åŒ¹é…åº¦æå‡ | ä» 60% æå‡è‡³ 80%+ |

---

### Phase 3ï¼šAtomic ç»„ä»¶èµ„äº§åŒ–ï¼ˆ14-21 å¤©ï¼‰

**ç›®æ ‡**ï¼šæ„å»ºå¯è·¨é¡¹ç›®å¤ç”¨çš„åŸå­ç»„ä»¶åº“ï¼Œæ”¯æŒçµæ´»ç»„åˆå’Œæ™ºèƒ½åŒ¹é…

#### æ ¸å¿ƒä»»åŠ¡

**1. Atomic ç»„ä»¶æå–**
- **Button**ï¼šå˜ä½“ï¼ˆprimary/secondary/ghostï¼‰+ å°ºå¯¸ + çŠ¶æ€
- **Badge/Tag**ï¼šæ ·å¼å˜ä½“ + å›¾æ ‡æ”¯æŒ
- **Card**ï¼šåŸºç¡€å¡ç‰‡ + å¤´éƒ¨/å†…å®¹/åº•éƒ¨ slot
- **Image/Media**ï¼šå“åº”å¼ + å ä½ç¬¦ + æ‡’åŠ è½½
- **Input/Form**ï¼šè¡¨å•å…ƒç´  + éªŒè¯çŠ¶æ€

**2. è¯­ä¹‰ç´¢å¼•ç³»ç»Ÿï¼ˆæ–°å¢ï¼‰**
- ä¸ºæ¯ä¸ªèµ„äº§ç”Ÿæˆ embedding å‘é‡
- æ ‡æ³¨ï¼šindustry/tone/conversion_goal
- æ”¯æŒè¯­ä¹‰æœç´¢ï¼ˆ"æˆ‘è¦ä¸€ä¸ªé«˜ç«¯é‡‘èé£çš„ Hero"ï¼‰

**3. èµ„äº§åº“æ¶æ„**

```
/asset-library/
  /patterns/                 # è·¨ç«™ç‚¹é€šç”¨æ¨¡å¼
    hero-cta.pattern.json
    feature-3col.pattern.json
  /components/               # ç»„ä»¶åº“ç´¢å¼•
    /CardsGrid/
      metadata.json          # ä½¿ç”¨ç»Ÿè®¡ã€é€‚ç”¨åœºæ™¯
      variants/
        3col-image-top.json
        4col-icon-left.json
    /Hero/
      metadata.json
      variants/
        video-background.json
        split-media.json
  /themes/                   # ä¸»é¢˜èšç±»
    /saas-minimal/
      tokens.json
      components/            # è¯¥ä¸»é¢˜ä¸‹çš„ç»„ä»¶
    /ecommerce-vibrant/
  /content-templates/        # æ–‡æ¡ˆæ¨¡æ¿ï¼ˆå·²å‚æ•°åŒ–ï¼‰
    hero-headlines.json
    cta-copy.json
```

**4. å…ƒæ•°æ®è§„èŒƒ**

```json
{
  "id": "hero-saas-001",
  "sourceUrl": "https://example.com",
  "extractedAt": "2026-01-27T10:30:00Z",
  "category": "hero",
  "tags": ["saas", "gradient-bg", "center-aligned", "video"],
  "complexity": "medium",
  "usageCount": 0,
  "qualityScore": 0.92,
  "responsive": true,
  "accessibility": "AA",
  "dependencies": ["Button", "Container", "GradientOverlay"],
  "semantic": {
    "intent": "product_launch",
    "tone": "professional_tech",
    "conversion_goal": "video_play",
    "industry": ["saas", "tech"]
  },
  "embedding": [0.123, -0.456, ...],
  "variants": [
    {
      "id": "hero-saas-001-v1",
      "description": "å±…ä¸­å¸ƒå±€",
      "props": {...}
    }
  ]
}
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| Atomic ç»„ä»¶æ•°é‡ | > 30 ä¸ªï¼ˆè¦†ç›–å¸¸è§åœºæ™¯ï¼‰ |
| è¯­ä¹‰ç´¢å¼•å‡†ç¡®åº¦ | > 85%ï¼ˆåŸºäºæµ‹è¯•æŸ¥è¯¢ï¼‰ |
| è·¨é¡¹ç›®å¤ç”¨æˆåŠŸç‡ | > 80%ï¼ˆéœ€è¦çš„è°ƒæ•´ < 20%ï¼‰ |
| å…ƒæ•°æ®å®Œæ•´æ€§ | 100%ï¼ˆæ‰€æœ‰å¿…å¡«å­—æ®µï¼‰ |

---

### Phase 4ï¼šè§†è§‰ QA é—­ç¯ï¼ˆæŒç»­ä¼˜åŒ–ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹è‡ªåŠ¨åŒ–éªŒè¯ä¸ä¿®å¤æµç¨‹ï¼Œå°†è§†è§‰ä¸€è‡´æ€§æå‡è‡³ 90%+ï¼Œå¹¶å‡å°‘ 70% äººå·¥è°ƒæ•´æ—¶é—´

#### æ ¸å¿ƒä»»åŠ¡

**1. å¤šç«¯è§†è§‰æµ‹è¯•**
- Desktop: 1440px, 1920px
- Mobile: 375px, 414px
- Tablet: 768px, 1024px

**2. å·®å¼‚å½’å› ç³»ç»Ÿ**
- **ç»“æ„å·®å¼‚**ï¼šmissing_block / bbox_shift / hierarchy_mismatch
- **Token å·®å¼‚**ï¼šfont/color/spacing/shadow åå·®
- **å†…å®¹å·®å¼‚**ï¼šbroken_images / failed_requests / text_overflow

**3. è‡ªåŠ¨ä¿®å¤ç­–ç•¥**
- **è§„åˆ™ä¿®å¤**ï¼šç®€å• token è°ƒæ•´ï¼ˆé¢œè‰²/é—´è·ï¼‰
- **LLM ä¿®å¤**ï¼šå¤æ‚ç»“æ„è°ƒæ•´ï¼ˆéœ€è¦ä¸Šä¸‹æ–‡ç†è§£ï¼‰
- **äººå·¥é—¸é—¨**ï¼šmissing_block æˆ– broken_images è§¦å‘

**4. åœæ­¢æ¡ä»¶**
- Desktop + Mobile å‡è¾¾ç›®æ ‡ç›¸ä¼¼åº¦ï¼ˆ> 90%ï¼‰
- æå‡ä¸è¶³ï¼ˆMIN_IMPROVEMENT < 2%ï¼‰
- è§¦å‘äººå·¥è¯„å®¡
- è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼ˆ3 æ¬¡ï¼‰

```typescript
// Phase 4: è‡ªåŠ¨ä¿®å¤é—­ç¯
async function autoRepairLoop(siteKey: string, page: string) {
  let iteration = 0;
  const MAX_ITERATIONS = 3;
  const TARGET_SIMILARITY = 0.90;
  const MIN_IMPROVEMENT = 0.02;
  
  let prevSimilarity = 0;
  
  while (iteration < MAX_ITERATIONS) {
    // 1. è§†è§‰å¯¹æ¯”
    const diffResult = await runVisualQA(siteKey, page);
    
    // 2. æ£€æŸ¥åœæ­¢æ¡ä»¶
    if (diffResult.similarity.desktop > TARGET_SIMILARITY && 
        diffResult.similarity.mobile > TARGET_SIMILARITY) {
      console.log('âœ… è¾¾åˆ°ç›®æ ‡ç›¸ä¼¼åº¦');
      break;
    }
    
    if (Math.abs(diffResult.similarity.desktop - prevSimilarity) < MIN_IMPROVEMENT) {
      console.log('âš ï¸ æå‡ä¸è¶³ï¼Œåœæ­¢è¿­ä»£');
      break;
    }
    
    // 3. å·®å¼‚å½’å› 
    const attribution = await attributeDifferences(diffResult);
    
    // 4. è§¦å‘äººå·¥è¯„å®¡é—¸é—¨
    if (attribution.critical_issues.length > 0) {
      console.log('ğŸš¨ å‘ç°å…³é”®é—®é¢˜ï¼Œéœ€è¦äººå·¥è¯„å®¡');
      await notifyHumanReview(attribution.critical_issues);
      break;
    }
    
    // 5. ç”Ÿæˆä¿®å¤æ–¹æ¡ˆ
    const patch = await generatePatch(attribution);
    
    // 6. åº”ç”¨ä¿®å¤
    await applyPatch(siteKey, page, patch, iteration);
    
    prevSimilarity = diffResult.similarity.desktop;
    iteration++;
  }
  
  return { finalSimilarity: diffResult.similarity, iterations: iteration };
}
```

#### éªŒæ”¶æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| Desktop ç›¸ä¼¼åº¦ | > 90% |
| Mobile ç›¸ä¼¼åº¦ | > 90% |
| è‡ªåŠ¨ä¿®å¤æˆåŠŸç‡ | > 70%ï¼ˆæ— éœ€äººå·¥ï¼‰ |
| å¹³å‡è¿­ä»£æ¬¡æ•° | < 2 æ¬¡ |

---

## 5. æŠ€æœ¯æ ˆä¸ä¾èµ–

| ç±»åˆ« | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| **å‰ç«¯æ¸²æŸ“** | Next.js 14<br/>React 18<br/>Tailwind CSS<br/>shadcn/ui | é¡µé¢æ¸²æŸ“ã€ç»„ä»¶ç³»ç»Ÿã€æ ·å¼æ¡†æ¶å’Œ UI ç»„ä»¶åº“ |
| **ç¼–è¾‘å™¨** | Puck Editor<br/>Magic UI | å¯è§†åŒ–ç¼–è¾‘å’ŒåŠ¨æ•ˆç»„ä»¶ |
| **çˆ¬å–é‡‡é›†** | Playwright<br/>Crawl4AI<br/>Chrome DevTools Protocol | é¡µé¢é‡‡é›†ã€DOM åˆ†æã€æˆªå›¾ç”Ÿæˆå’Œæ–‡æœ¬æå– |
| **è§†è§‰å¤„ç†** | OpenCV<br/>pixelmatch<br/>pngjs<br/>sharp | å›¾åƒå¤„ç†ã€åƒç´ å¯¹æ¯”ã€å¸ƒå±€è¯†åˆ« |
| **AI/ML** | OpenRouter<br/>Sentence Transformers<br/>CLIP | LLM ç»“æ„åŒ–è¾“å‡ºã€è¯­ä¹‰æœç´¢ã€è§†è§‰åˆ†ç±» |
| **æ•°æ®å¤„ç†** | Python 3.11+<br/>Node.js 18+<br/>TypeScript | Pipeline è„šæœ¬ã€æ•°æ®è½¬æ¢ã€ç±»å‹å®‰å…¨ |
| **å­˜å‚¨** | JSON<br/>File System<br/>SQLite (å¯é€‰) | èµ„äº§å­˜å‚¨ã€å…ƒæ•°æ®ç´¢å¼• |

---

## 6. å®Œæ•´ç›®å½•ç»“æ„

```
/shipitto-toolchain/
â”œâ”€â”€ asset-factory/              # èµ„äº§å·¥å‚ï¼ˆæ ¸å¿ƒæµæ°´çº¿ï¼‰
â”‚   â”œâ”€â”€ blocks/                 # Block æ³¨å†Œè¡¨
â”‚   â”‚   â”œâ”€â”€ registry.json       # æ‰€æœ‰ Block å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ variants/           # Block å˜ä½“ prompts
â”‚   â”‚   â””â”€â”€ schemas/            # Block Props JSON Schema
â”‚   â”œâ”€â”€ pipelines/              # æµæ°´çº¿è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ capture.py          # Phase 0 é‡‡é›†
â”‚   â”‚   â”œâ”€â”€ extract.py          # Phase 1 ç†è§£
â”‚   â”‚   â”œâ”€â”€ design_system.py    # Phase 1.5 è®¾è®¡ç³»ç»Ÿæå–ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ map.py              # Phase 2 æ˜ å°„
â”‚   â”‚   â”œâ”€â”€ build.py            # Phase 2 æ„å»º
â”‚   â”‚   â””â”€â”€ verify.py           # Phase 4 éªŒè¯
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ tailwind_mapper.py  # Tailwind å½’ä¸€åŒ–ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ layout_classifier.py # å¸ƒå±€æ‹“æ‰‘è¯†åˆ«ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â””â”€â”€ semantic_indexer.py # è¯­ä¹‰ç´¢å¼•ï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ out/                    # ç«™ç‚¹èµ„äº§è¾“å‡º
â”‚       â””â”€â”€ <site_key>/
â”‚           â”œâ”€â”€ capture/        # åŸå§‹é‡‡é›†
â”‚           â”œâ”€â”€ atoms/          # atoms_dsl
â”‚           â”œâ”€â”€ extract/        # æ–‡æœ¬ç»“æ„
â”‚           â”œâ”€â”€ design-system/  # è®¾è®¡ç³»ç»Ÿï¼ˆæ–°å¢ï¼‰
â”‚           â”‚   â”œâ”€â”€ tokens.json
â”‚           â”‚   â”œâ”€â”€ tailwind.config.js
â”‚           â”‚   â””â”€â”€ patterns/
â”‚           â”œâ”€â”€ pages/          # Puck JSON
â”‚           â”œâ”€â”€ theme/          # Theme tokens
â”‚           â”œâ”€â”€ visual-qa/      # QA ç»“æœ
â”‚           â””â”€â”€ work/           # è¿­ä»£ç‰ˆæœ¬

â”œâ”€â”€ asset-library/              # è·¨ç«™ç‚¹èµ„äº§åº“ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ patterns/               # é€šç”¨æ¨¡å¼
â”‚   â”œâ”€â”€ components/             # ç»„ä»¶ç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ CardsGrid/
â”‚   â”‚   â”‚   â”œâ”€â”€ metadata.json
â”‚   â”‚   â”‚   â””â”€â”€ variants/
â”‚   â”‚   â””â”€â”€ Hero/
â”‚   â”œâ”€â”€ themes/                 # ä¸»é¢˜èšç±»
â”‚   â””â”€â”€ content-templates/      # æ–‡æ¡ˆæ¨¡æ¿

â”œâ”€â”€ builder/                    # Puck æ¸²æŸ“å™¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ atoms/          # shadcn wrappers
â”‚   â”‚   â”‚   â””â”€â”€ blocks/         # Block å®ç°
â”‚   â”‚   â”œâ”€â”€ puck/               # Puck config
â”‚   â”‚   â””â”€â”€ app/
â”‚   â”‚       â”œâ”€â”€ editor/         # ç¼–è¾‘å™¨
â”‚   â”‚       â””â”€â”€ render/         # æ¸²æŸ“ç«¯ç‚¹
â”‚   â””â”€â”€ public/theme/           # Global theme

â”œâ”€â”€ visual-qa/                  # è§†è§‰ QA å·¥å…·
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ capture.ts          # æˆªå›¾é‡‡é›†
â”‚       â”œâ”€â”€ diff.ts             # pixelmatch diff
â”‚       â”œâ”€â”€ attribution.ts      # å·®å¼‚å½’å› 
â”‚       â””â”€â”€ run-loop.ts         # è‡ªåŠ¨ä¿®å¤é—­ç¯

â””â”€â”€ scripts/
    â”œâ”€â”€ run_excel_pipeline.py   # Excel æ‰¹é‡å¤„ç†
    â””â”€â”€ search_assets.py        # èµ„äº§æœç´¢ APIï¼ˆæ–°å¢ï¼‰
```

---

## 7. å…³é”®æ¨¡å—è¯¦è§£

### 7.1 Tailwind å½’ä¸€åŒ–å¼•æ“

```python
class TailwindMapper:
    """å°†åƒç´ å€¼æ˜ å°„ä¸º Tailwind ç±»"""
    
    def __init__(self, design_tokens):
        self.spacing_scale = design_tokens['spacing']  # [4,8,16,24,32,48,64,96,128]
        self.color_tokens = design_tokens['colors']
        self.font_sizes = design_tokens['typography']['fontSize']
    
    def spacing(self, px_value: int) -> str:
        """
        å°†åƒç´ å€¼æ˜ å°„ä¸ºæœ€æ¥è¿‘çš„ Tailwind spacing
        41px â†’ "10" (Tailwind: 2.5rem = 40px)
        """
        rem_value = px_value / 16
        tailwind_value = round(rem_value * 4)  # Tailwind ä»¥ 0.25rem ä¸ºå•ä½
        return str(tailwind_value)
    
    def color(self, hex_color: str) -> str:
        """
        å°† hex é¢œè‰²æ˜ å°„ä¸º Tailwind é¢œè‰²
        #2563EB â†’ "blue-600"
        """
        # 1. æ£€æŸ¥æ˜¯å¦åŒ¹é… theme tokens
        if hex_color in self.color_tokens:
            return self.color_tokens[hex_color]
        
        # 2. è®¡ç®—ä¸ Tailwind é»˜è®¤è°ƒè‰²æ¿çš„è·ç¦»
        closest_color = find_closest_tailwind_color(hex_color)
        return closest_color  # e.g., "blue-600"
    
    def fontSize(self, px_value: int) -> str:
        """18px â†’ "lg" (Tailwind: 1.125rem = 18px)"""
        size_map = {12: "xs", 14: "sm", 16: "base", 18: "lg", 20: "xl", 24: "2xl"}
        return size_map.get(px_value, "base")
    
    def borderRadius(self, px_value: int) -> str:
        """12px â†’ "xl" (Tailwind: 0.75rem = 12px)"""
        radius_map = {2: "sm", 4: "", 6: "md", 8: "lg", 12: "xl", 16: "2xl", 9999: "full"}
        return radius_map.get(px_value, "")

# ä½¿ç”¨ç¤ºä¾‹
def normalize_block_props(raw_props, design_tokens):
    mapper = TailwindMapper(design_tokens)
    
    normalized = {
        "padding": {
            "top": mapper.spacing(raw_props['paddingTop']),
            "bottom": mapper.spacing(raw_props['paddingBottom'])
        },
        "backgroundColor": mapper.color(raw_props['backgroundColor']),
        "fontSize": mapper.fontSize(raw_props['fontSize']),
        "borderRadius": mapper.borderRadius(raw_props['borderRadius'])
    }
    
    return normalized
```

### 7.2 è¯­ä¹‰ç´¢å¼•ä¸æœç´¢

```python
from sentence_transformers import SentenceTransformer
import numpy as np

class SemanticAssetSearch:
    """åŸºäºè¯­ä¹‰çš„èµ„äº§æœç´¢å¼•æ“"""
    
    def __init__(self):
        self.model = SentenceTransformer('all-MiniLM-L6-v2')
        self.asset_index = []  # [(asset_id, embedding, metadata), ...]
    
    def index_asset(self, asset_id, description, metadata):
        """ä¸ºèµ„äº§ç”Ÿæˆ embedding å¹¶ç´¢å¼•"""
        # ç»„åˆæ–‡æœ¬
        text = f"{description} {metadata.get('tags', [])} {metadata.get('semantic', {}).get('tone', '')}"
        embedding = self.model.encode(text)
        
        self.asset_index.append({
            "id": asset_id,
            "embedding": embedding,
            "metadata": metadata
        })
    
    def search(self, query, top_k=5, filters=None):
        """
        è¯­ä¹‰æœç´¢
        query: "æˆ‘è¦ä¸€ä¸ªé«˜ç«¯é‡‘èé£çš„ Hero åŒºå—ï¼Œå¸¦è§†é¢‘èƒŒæ™¯"
        filters: {"category": "hero", "responsive": true}
        """
        # 1. ç”ŸæˆæŸ¥è¯¢ embedding
        query_embedding = self.model.encode(query)
        
        # 2. è®¡ç®—ç›¸ä¼¼åº¦
        results = []
        for item in self.asset_index:
            # åº”ç”¨è¿‡æ»¤å™¨
            if filters and not self._match_filters(item['metadata'], filters):
                continue
            
            similarity = np.dot(query_embedding, item['embedding'])
            results.append({
                "id": item['id'],
                "similarity": float(similarity),
                "metadata": item['metadata']
            })
        
        # 3. æ’åºå¹¶è¿”å›
        results.sort(key=lambda x: x['similarity'], reverse=True)
        return results[:top_k]
    
    def _match_filters(self, metadata, filters):
        for key, value in filters.items():
            if metadata.get(key) != value:
                return False
        return True

# ä½¿ç”¨ç¤ºä¾‹
searcher = SemanticAssetSearch()

# ç´¢å¼•èµ„äº§
searcher.index_asset(
    "hero-saas-001",
    "Video background hero with gradient overlay",
    {
        "category": "hero",
        "tags": ["saas", "video", "gradient"],
        "semantic": {"tone": "professional_tech", "industry": ["saas"]},
        "responsive": True
    }
)

# æœç´¢
results = searcher.search(
    "æˆ‘è¦ä¸€ä¸ªä¸“ä¸šç§‘æŠ€é£æ ¼çš„é¦–å±ï¼Œå¸¦è§†é¢‘",
    filters={"category": "hero", "responsive": True}
)
# è¿”å›ï¼š[{"id": "hero-saas-001", "similarity": 0.82, ...}]
```

### 7.3 å¸ƒå±€æ‹“æ‰‘è¯†åˆ«

```python
import cv2
import numpy as np

class LayoutTopologyClassifier:
    """è¯†åˆ«åŒºå—çš„å¸ƒå±€æ‹“æ‰‘ç±»å‹"""
    
    def classify(self, section_img_path):
        """
        åˆ†ç±»å¸ƒå±€ç±»å‹
        è¿”å›ï¼š{"type": "left_media_right_text", "grid": {...}, "hierarchy": "..."}
        """
        img = cv2.imread(section_img_path)
        
        # 1. æ£€æµ‹å›¾åƒåŒºåŸŸ
        image_regions = self._detect_images(img)
        
        # 2. æ£€æµ‹æ–‡æœ¬å—
        text_blocks = self._detect_text_blocks(img)
        
        # 3. è®¡ç®—å¸ƒå±€ç‰¹å¾
        features = {
            "has_large_image": any(r['area'] > img.shape[0] * img.shape[1] * 0.3 for r in image_regions),
            "image_left": any(r['center_x'] < img.shape[1] * 0.4 for r in image_regions),
            "image_right": any(r['center_x'] > img.shape[1] * 0.6 for r in image_regions),
            "centered_text": self._is_centered(text_blocks, img.shape[1]),
            "grid_layout": self._detect_grid(image_regions + text_blocks)
        }
        
        # 4. è§„åˆ™åˆ†ç±»
        if features['image_left'] and features['has_large_image']:
            return {
                "type": "left_media_right_text",
                "hierarchy": "media_dominant",
                "grid": None
            }
        elif features['image_right'] and features['has_large_image']:
            return {
                "type": "right_media_left_text",
                "hierarchy": "media_dominant",
                "grid": None
            }
        elif features['centered_text'] and not features['has_large_image']:
            return {
                "type": "centered_text",
                "hierarchy": "text_only",
                "grid": None
            }
        elif features['grid_layout']:
            return {
                "type": "grid",
                "hierarchy": "balanced",
                "grid": features['grid_layout']  # {"cols": 3, "rows": 2}
            }
        else:
            return {
                "type": "mixed",
                "hierarchy": "unknown",
                "grid": None
            }
    
    def _detect_images(self, img):
        """ä½¿ç”¨è¾¹ç¼˜æ£€æµ‹è¯†åˆ«å›¾åƒåŒºåŸŸ"""
        gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
        edges = cv2.Canny(gray, 50, 150)
        contours, _ = cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
        
        regions = []
        for contour in contours:
            x, y, w, h = cv2.boundingRect(contour)
            if w * h > 10000:  # è¿‡æ»¤å°åŒºåŸŸ
                regions.append({
                    "bbox": (x, y, w, h),
                    "area": w * h,
                    "center_x": x + w / 2,
                    "center_y": y + h / 2
                })
        return regions
    
    def _is_centered(self, blocks, img_width):
        """æ£€æŸ¥æ–‡æœ¬æ˜¯å¦å±…ä¸­"""
        if not blocks:
            return False
        avg_center = np.mean([b['center_x'] for b in blocks])
        return abs(avg_center - img_width / 2) < img_width * 0.1
    
    def _detect_grid(self, elements):
        """æ£€æµ‹æ˜¯å¦ä¸ºç½‘æ ¼å¸ƒå±€"""
        if len(elements) < 4:
            return None
        
        # ç®€åŒ–ç‰ˆï¼šæ£€æŸ¥å…ƒç´ æ˜¯å¦ç­‰é—´è·æ’åˆ—
        x_positions = sorted([e['center_x'] for e in elements])
        gaps = [x_positions[i+1] - x_positions[i] for i in range(len(x_positions)-1)]
        
        if np.std(gaps) < 50:  # é—´è·æ ‡å‡†å·®å°äº 50px
            cols = len(set([int(e['center_x'] / 200) for e in elements]))
            rows = len(set([int(e['center_y'] / 200) for e in elements]))
            return {"cols": cols, "rows": rows}
        
        return None
```

### 7.4 æ•´ç«™æ¨¡æ¿é™æ€ç»„ä»¶æ³¨å†Œï¼ˆä¸å•é¡µæ¨¡æ¿å¯¹é½ï¼‰

ä¸ºä¿è¯æ•´ç«™æ¨¡æ¿åœ¨ç”Ÿäº§ç¯å¢ƒå…·å¤‡å¯æ„å»ºã€å¯éƒ¨ç½²ã€å¯ç¼–è¾‘èƒ½åŠ›ï¼Œæ–°å¢å¹¶è½åœ°é™æ€ç»„ä»¶æ³¨å†Œé“¾è·¯ï¼š

`LLM ç”Ÿæˆç»„ä»¶ä»£ç  -> å†™å…¥ src/components/blocks/*/block.tsx -> æ³¨å†Œåˆ° src/puck/config.ts -> next build`

#### å…³é”®è®¾è®¡

1. **ç‰©åŒ–å…¥å£ï¼ˆtemplate-factoryï¼‰**
   - ä» `payload.json` è¯»å– `components[].code`
   - å†™å…¥ `builder/src/components/blocks/<kebab-name>/block.tsx`
   - ç”Ÿæˆ `builder/src/puck/config.generated.ts`
2. **Puck æ³¨å†Œåˆå¹¶**
   - `builder/src/puck/config.ts` é™æ€å¯¼å…¥ `./config.generated`
   - é€šè¿‡ `Object.assign(puckConfig.components, generatedComponents)` åˆå¹¶
   - æä¾›ç©ºçš„ `config.generated.ts` å…œåº•ï¼Œé¿å…é¦–æ¬¡æ„å»ºæ—¶æ¨¡å—ç¼ºå¤±
3. **å†²çªæ²»ç†ï¼ˆå¤šç«™/å¤šé¡µï¼‰**
   - åŒååŒä»£ç ï¼šå»é‡
   - åŒåä¸åŒä»£ç ï¼šè‡ªåŠ¨è¿½åŠ å“ˆå¸Œåç¼€ï¼ˆå¦‚ `_a1b2c3d4`ï¼‰
   - è¾“å‡º `collisionFrom/signature` ä¾¿äºè¿½è¸ª

#### éªŒæ”¶æ ‡å‡†

| ç»´åº¦ | è¯„ä¼° |
|------|------|
| è§†è§‰ä¿çœŸåº¦ | é«˜ï¼ˆåŒæ ·ç”± LLM ç”Ÿæˆç»„ä»¶ï¼‰ |
| Puck ç¼–è¾‘ | âœ… `fields/defaultProps` æ˜¾å¼æ³¨å†Œ |
| æ„å»ºæ—¶å¯ç”¨ | âœ… æ ‡å‡† Next.js æ„å»ºé“¾è·¯ |
| Cloudflare Pages | âœ… `next build` åå¯è¡”æ¥é™æ€éƒ¨ç½² |
| é¦–å±æ€§èƒ½ | âœ… æ— è¿è¡Œæ—¶ JIT ç¼–è¯‘å¼€é”€ |
| SSR/SSG | âœ… `<Render config={config} data={data} />` |

---

## 8. è´¨é‡ä¿è¯ä½“ç³»

### 8.1 å¤šç»´åº¦è´¨é‡è¯„ä¼°

| ç»´åº¦ | æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|------|--------|
| **è§†è§‰è´¨é‡** | åƒç´ ç›¸ä¼¼åº¦<br/>ç»“æ„ä¸€è‡´æ€§<br/>å“åº”å¼è¡¨ç° | > 90% (Desktop)<br/>> 90% (Mobile)<br/>å®Œç¾é€‚é… 3 ç§æ–­ç‚¹ |
| **ä»£ç è´¨é‡** | Tailwind è¦†ç›–ç‡<br/>Schema åˆè§„æ€§<br/>ç»„ä»¶å¤æ‚åº¦ | > 95%<br/>100%<br/>Cyclomatic < 10 |
| **æ€§èƒ½** | Pipeline è€—æ—¶<br/>æ¸²æŸ“é€Ÿåº¦<br/>èµ„æºå¤§å° | < 5 åˆ†é’Ÿ/ç«™<br/>LCP < 2.5s<br/>JS Bundle < 200KB |
| **å¯ç”¨æ€§** | æ— éšœç¢æ€§<br/>æµè§ˆå™¨å…¼å®¹<br/>é”™è¯¯ç‡ | WCAG AA<br/>Chrome/Safari/Firefox<br/>< 5% |
| **å¤ç”¨æ€§** | è·¨é¡¹ç›®é€‚é…ç‡<br/>ä¸»é¢˜åˆ‡æ¢æˆåŠŸç‡<br/>æ–‡æ¡£å®Œæ•´æ€§ | > 80%<br/>> 95%<br/>100% |

### 8.2 æµ‹è¯•ç­–ç•¥

- **å•å…ƒæµ‹è¯•**ï¼šæ‰€æœ‰ utils æ¨¡å—ï¼ˆTailwind mapper/Layout classifierï¼‰
- **é›†æˆæµ‹è¯•**ï¼šPipeline ç«¯åˆ°ç«¯æµç¨‹ï¼ˆCapture â†’ Build â†’ Verifyï¼‰
- **è§†è§‰å›å½’æµ‹è¯•**ï¼šæ¯ä¸ª Block çš„æ ‡å‡†æ ·ä¾‹ï¼ˆGolden Masterï¼‰
- **æ€§èƒ½æµ‹è¯•**ï¼šPipeline è€—æ—¶ï¼ˆç›®æ ‡ï¼šå•ç«™ < 5 åˆ†é’Ÿï¼‰

---

## 9. ä½¿ç”¨æŒ‡å—

### 9.1 å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
npm install
pip install -r requirements.txt

# 2. å•ç«™ç‚¹æå–
python3 asset-factory/pipelines/run.py \
  --url https://example.com \
  --output-key demo

# 3. å¯åŠ¨æ¸²æŸ“æœåŠ¡
cd builder
npm run dev

# 4. æŸ¥çœ‹ç»“æœ
open http://localhost:3000/render?siteKey=demo&page=home

# 5. è¿è¡Œè§†è§‰ QA
cd visual-qa
SITE_KEY=demo \
ORIGINAL_URL="https://example.com" \
RENDER_URL="http://localhost:3000/render?siteKey=demo" \
node --loader ts-node/esm scripts/run-with-attribution.ts
```

### 9.2 æ‰¹é‡å¤„ç†ï¼ˆExcelï¼‰

```bash
# Excel æ ¼å¼è¦æ±‚
# | Site Name | URL                    | Priority |
# | Demo      | https://example.com    | High     |

python3 scripts/run_excel_pipeline.py \
  --excel sites.xlsx \
  --sheet "Sites" \
  --parallel 3  # å¹¶å‘æ•°

# è¾“å‡ºï¼š
# - asset-factory/out/<siteKey>/
# - output/reports/excel_pipeline_report.json
```

### 9.3 èµ„äº§æœç´¢ä¸å¤ç”¨

```python
from scripts.search_assets import AssetSearchEngine

# åˆå§‹åŒ–æœç´¢å¼•æ“
search = AssetSearchEngine()
search.load_index()  # åŠ è½½å·²ç´¢å¼•çš„èµ„äº§

# è¯­ä¹‰æœç´¢
results = search.search(
    query="æˆ‘éœ€è¦ä¸€ä¸ªé«˜ç«¯é‡‘èé£æ ¼çš„é¦–å±ï¼Œå¸¦å¤§å›¾èƒŒæ™¯",
    category="hero",
    filters={"responsive": True, "accessibility": "AA"}
)

# ç»“æœï¼š
# [
#   {
#     "id": "hero-finance-001",
#     "similarity": 0.89,
#     "metadata": {...},
#     "preview_url": "..."
#   }
# ]

# é¢„è§ˆèµ„äº§
preview_url = search.preview(
    asset_id="hero-finance-001",
    theme="custom-theme-001"
)

# å¤ç”¨èµ„äº§åˆ°æ–°é¡¹ç›®
search.export_asset(
    asset_id="hero-finance-001",
    target_project="/path/to/new-project",
    adapt_theme=True  # è‡ªåŠ¨é€‚é…æ–°ä¸»é¢˜
)
```

### 9.4 æ•´ç«™æ¨¡æ¿é™æ€ç»„ä»¶ç‰©åŒ–ï¼ˆBuilderï¼‰

```bash
# åœ¨ builder ç›®å½•æ‰§è¡Œ
cd builder

# 1) ä» template-factory æŸæ¬¡ run ç»“æœç‰©åŒ–é™æ€ç»„ä»¶
node template-factory/materialize-custom-components.mjs \
  --run-dir template-factory/runs/<run-id>

# 2) éªŒè¯ç”Ÿäº§æ„å»º
npm run build
```

å¦‚éœ€è¦†ç›–å·²å­˜åœ¨ block æ–‡ä»¶ï¼š

```bash
node template-factory/materialize-custom-components.mjs \
  --run-dir template-factory/runs/<run-id> \
  --overwrite
```

---

## 10. é£é™©ä¸ç¼“è§£ç­–ç•¥

| é£é™© | å½±å“ | å¯èƒ½æ€§ | ç¼“è§£ç­–ç•¥ |
|------|------|--------|---------|
| JS-heavy ç½‘ç«™ DOM ä¸ç¨³å®š | é«˜ | ä¸­ | ä¾èµ–æˆªå›¾åˆ†å‰² + computed stylesï¼Œè€Œé DOM ç»“æ„ |
| æ¨¡æ¿æ•°é‡çˆ†ç‚¸ | ä¸­ | é«˜ | å¼ºåˆ¶ Block å˜ä½“ä¸Šé™ï¼ˆ< 20ï¼‰ï¼Œä½¿ç”¨ Atomic ç»„åˆæ›¿ä»£ |
| LLM æˆæœ¬è¿‡é«˜ | ä¸­ | ä¸­ | ä¼˜å…ˆä½¿ç”¨è§„åˆ™å¼•æ“ï¼ŒLLM ä»…ç”¨äºå¤æ‚åœºæ™¯ |
| è§†è§‰è¿˜åŸåº¦ä¸è¾¾æ ‡ | é«˜ | ä½ | è§†è§‰é—­ç¯è¿­ä»£ + äººå·¥è¯„å®¡é—¸é—¨ |
| è·¨ç«™ç‚¹å¤ç”¨å¤±è´¥ | ä¸­ | ä¸­ | Tailwind å½’ä¸€åŒ– + è¯­ä¹‰ç´¢å¼• + ä¸»é¢˜é€‚é… |
| æ€§èƒ½ç“¶é¢ˆ | ä½ | ä¸­ | å¹¶è¡Œå¤„ç† + å¢é‡æ›´æ–° + ç¼“å­˜ç­–ç•¥ |
| æ— éšœç¢æ€§ä¸è¶³ | ä¸­ | ä¸­ | è‡ªåŠ¨åŒ–æ£€æµ‹ï¼ˆaxe-coreï¼‰+ äººå·¥å®¡æŸ¥ |

---

## 11. æœªæ¥æ‰©å±•è§„åˆ’

### 11.1 çŸ­æœŸï¼ˆ3 ä¸ªæœˆå†…ï¼‰

- æ”¯æŒæ›´å¤š CSS æ¡†æ¶ï¼ˆMaterial UI/Ant Designï¼‰
- å¢åŠ  Block æ•°é‡è‡³ 50+
- ä¼˜åŒ–æ€§èƒ½ï¼ˆPipeline è€—æ—¶å‡å°‘ 50%ï¼‰
- Web UI ç•Œé¢ï¼ˆæ›¿ä»£å‘½ä»¤è¡Œï¼‰

### 11.2 ä¸­æœŸï¼ˆ6 ä¸ªæœˆå†…ï¼‰

- AI è¾…åŠ©ä¼˜åŒ–ï¼šåŸºäºè½¬åŒ–æ•°æ®æ¨èå¸ƒå±€
- åä½œåŠŸèƒ½ï¼šè®¾è®¡å¸ˆæ ‡æ³¨ç³»ç»Ÿ + è¯„è®º
- ç‰ˆæœ¬æ§åˆ¶ï¼šèµ„äº§å˜æ›´å†å² + å›æ»š
- API æœåŠ¡åŒ–ï¼šæä¾› RESTful API

### 11.3 é•¿æœŸï¼ˆ12 ä¸ªæœˆå†…ï¼‰

- è·¨å¹³å°æ”¯æŒï¼šFlutter/React Native ç»„ä»¶ç”Ÿæˆ
- è®¾è®¡å¸ˆå·¥å…·é›†æˆï¼šFigma/Sketch æ’ä»¶
- å•†ä¸šåŒ–æ”¯æŒï¼šä»˜è´¹ç»„ä»¶åº“ + SaaS æœåŠ¡
- å¤šè¯­è¨€æ”¯æŒï¼šå†…å®¹è‡ªåŠ¨ç¿»è¯‘ + æœ¬åœ°åŒ–

---

## 12. é™„å½•

### é™„å½• Aï¼šBlock æ³¨å†Œè¡¨ç¤ºä¾‹

```json
{
  "blocks": [
    {
      "id": "HeroVideo",
      "category": "hero",
      "description": "Video background hero with overlay",
      "variants": ["center", "split", "fullscreen"],
      "props_schema": "schemas/blocks/hero-video.v1.json",
      "semantic": {
        "intent": "product_launch",
        "tone": ["professional", "tech", "modern"],
        "conversion_goal": "video_play",
        "industry": ["saas", "tech", "startup"]
      },
      "dependencies": ["Button", "Container", "VideoBackground", "GradientOverlay"],
      "responsive": true,
      "accessibility": "AA"
    },
    {
      "id": "CardsGrid",
      "category": "feature",
      "description": "Grid of feature/product/news cards",
      "variants": ["3col", "4col", "masonry"],
      "props_schema": "schemas/blocks/cards-grid.v1.json",
      "semantic": {
        "intent": "feature_showcase",
        "tone": ["informative", "organized"],
        "conversion_goal": "engagement",
        "industry": ["all"]
      },
      "dependencies": ["Card", "Image", "Badge"],
      "responsive": true,
      "accessibility": "AA"
    }
  ]
}
```

### é™„å½• Bï¼šTheme Tokens è§„èŒƒ

```json
{
  "colors": {
    "primary": {
      "50": "#EFF6FF",
      "600": "#2563EB",
      "900": "#1E3A8A"
    },
    "semantic": {
      "success": "#10B981",
      "warning": "#F59E0B",
      "error": "#EF4444"
    }
  },
  "spacing": {
    "base": 4,
    "scale": [4, 8, 12, 16, 24, 32, 48, 64, 96, 128]
  },
  "typography": {
    "fontFamily": {
      "sans": ["Inter", "system-ui", "sans-serif"],
      "serif": ["Merriweather", "Georgia", "serif"],
      "mono": ["Fira Code", "monospace"]
    },
    "fontSize": {
      "xs": "0.75rem",
      "sm": "0.875rem",
      "base": "1rem",
      "lg": "1.125rem",
      "xl": "1.25rem"
    },
    "fontWeight": {
      "normal": 400,
      "medium": 500,
      "semibold": 600,
      "bold": 700
    },
    "lineHeight": {
      "tight": 1.25,
      "normal": 1.5,
      "relaxed": 1.75
    }
  },
  "borderRadius": {
    "sm": "0.125rem",
    "md": "0.375rem",
    "lg": "0.5rem",
    "xl": "0.75rem",
    "full": "9999px"
  },
  "boxShadow": {
    "sm": "0 1px 2px 0 rgb(0 0 0 / 0.05)",
    "md": "0 4px 6px -1px rgb(0 0 0 / 0.1)",
    "lg": "0 10px 15px -3px rgb(0 0 0 / 0.1)"
  }
}
```

### é™„å½• Cï¼šå‚è€ƒèµ„æº

- **Anthropic Claude Documentation**: https://docs.anthropic.com
- **Puck Editor**: https://puckeditor.com
- **shadcn/ui**: https://ui.shadcn.com
- **Tailwind CSS**: https://tailwindcss.com
- **Playwright**: https://playwright.dev
- **Crawl4AI**: https://github.com/unclecode/crawl4ai
- **Sentence Transformers**: https://www.sbert.net

---

## æ–‡æ¡£ä¿¡æ¯

- **ç‰ˆæœ¬**ï¼š2.0
- **æ›´æ–°æ—¥æœŸ**ï¼š2026-01-28
- **ä½œè€…**ï¼šæŠ€æœ¯å›¢é˜Ÿ
- **çŠ¶æ€**ï¼šå·²å‘å¸ƒ

---

**å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»æŠ€æœ¯å›¢é˜Ÿ**
